2023-05-26 08:47:53 [info     ] **********************
2023-05-26 08:47:53 [info     ] ***** TIME  BAND *****
2023-05-26 08:47:53 [info     ] **********************
2023-05-26 08:47:53 [info     ] ** System   Setting **
2023-05-26 08:47:53 [info     ]   Random Seed : 31
2023-05-26 08:47:53 [info     ]   MODELS TAG  : all 
2023-05-26 08:47:53 [info     ]   OUTPUT DIR  : TIMEBAND/outputs/stock.sample/all 
2023-05-26 08:47:53 [info     ]   VERBOSITY   : 0 
2023-05-26 08:47:53 [info     ] ** TIMEBAND Setting **
2023-05-26 08:47:53 [info     ] Timeband Dataset Setting
2023-05-26 08:47:53 [info     ] Min Max info
        TARGET      origin MIN    cutoff min    origin MAX    cutoff max
------  --------  ------------  ------------  ------------  ------------
open                      9200       9190.80         35800      35835.80
high                      9280       9270.72         37000      37037.00
low                       8570       8561.43         34800      34834.80
close   O                 8850       8841.15         35200      35235.20
volume                   17120      17102.88      21017010   21038027.01
2023-05-26 08:47:53 [info     ] 
  Dataset: 
  - Config    : {'TAG': 'all', 'data_name': 'stock.sample', 'outputs': 'TIMEBAND/outputs/', 'pretrain': True, 'workers': 2, 'batch_size': 256, 'observed_len': 28, 'forecast_len': 28, 'verbosity': 0, 'prediction': True, 'path': 'TIMEBAND/outputs/stock.sample/all', 'models_path': 'TIMEBAND/outputs/stock.sample/all/models', 'logs_path': 'TIMEBAND/outputs/stock.sample/all/logs', 'logger': <utils.logger.Logger object at 0x7efb0afb5eb0>, 'device': device(type='cpu'), 'targets_dims': 1, 'directory': 'data/', 'targets': ['close'], 'drops': [], 'time_index': 'date', 'time_format': '%y-%m-%d', 'time_info': {'month': True, 'weekday': True, 'days': True, 'hours': False, 'minutes': False}, 'stride': 1, 'split_rate': 0.8, 'min_valid_scale': 2, 'sliding_step': 1, 'zero_is_missing': True, 'zero_impute': True, 'zero_ignore': True, 'cutoff': {'min': 0.0001, 'max': 0.0001}} 
  - File path : /home/administrator/Desktop/django_project/TIMEBAND/data/stock.sample.csv 
  - Time Idx  : date 
  - Length    : 3000 
  - Shape(E/D): (256, 28, 8) / (256, 28, 1) 
  - Targets   : ['close'] (1 cols) 
  - Cut Scale : Min 0.0001, Max 0.0001  - Input Col : Index(['open', 'high', 'low', 'close', 'volume', 'months', 'weekday', 'days'], dtype='object')
2023-05-26 08:47:53 [info     ] Timeband Model Setting
2023-05-26 08:47:53 [info     ] 
  Model: 
  - File path  : TIMEBAND/outputs/stock.sample/all/models 
  - Pretrained : True 
  - Save opts  : True 
  - Load opts  : True 

2023-05-26 08:47:53 [info     ] 
  Dashboard: 
  - visualize : False 

2023-05-26 08:47:53 [info     ] ** Model   Training **
2023-05-26 08:47:53 [info     ]  - Initiated netD : LSTMDiscriminator(
  (lstm): LSTM(1, 256, batch_first=True)
  (linear): Sequential(
    (0): Linear(in_features=256, out_features=1, bias=True)
    (1): Sigmoid()
  )
), netG: LSTMGenerator(
  (lstm0): LSTM(8, 64, batch_first=True)
  (lstm1): LSTM(64, 128, batch_first=True)
  (lstm2): LSTM(128, 256, batch_first=True)
  (linear): Sequential(
    (0): Linear(in_features=256, out_features=1, bias=True)
    (1): Tanh()
  )
)
2023-05-26 08:47:53 [info     ] ***  MODEL IS SAVED ***
2023-05-26 08:47:53 [info     ] Train (1/2)
2023-05-26 08:47:53 [info     ]  - BEST Model Loading : TIMEBAND/outputs/stock.sample/all/models/netD_BEST.pth, TIMEBAND/outputs/stock.sample/all/models/netG_BEST.pth
2023-05-26 08:47:54 [info     ]   - Train size : 2344, Valid size 601
2023-05-26 08:47:54 [info     ] Train the model
2023-05-26 08:48:14 [info     ] *** Best(0.299) MODEL IS SAVED ***
2023-05-26 08:51:05 [info     ] *** Best(0.287) MODEL IS SAVED ***
2023-05-26 08:51:05 [info     ] ***  MODEL IS SAVED ***
2023-05-26 08:51:05 [info     ]  - BEST Model Loading : TIMEBAND/outputs/stock.sample/all/models/netD_BEST.pth, TIMEBAND/outputs/stock.sample/all/models/netG_BEST.pth
2023-05-26 08:51:05 [info     ] *** Best() MODEL IS SAVED ***
2023-05-26 08:51:05 [info     ] Done (1/2) 
2023-05-26 08:51:05 [info     ] Train (2/2)
2023-05-26 08:51:05 [info     ]  - BEST Model Loading : TIMEBAND/outputs/stock.sample/all/models/netD_BEST.pth, TIMEBAND/outputs/stock.sample/all/models/netG_BEST.pth
2023-05-26 08:51:06 [info     ]   - Train size : 2344, Valid size 601
2023-05-26 08:51:06 [info     ] Train the model
2023-05-26 08:51:26 [info     ] *** Best(0.273) MODEL IS SAVED ***
2023-05-26 08:51:47 [info     ] *** Best(0.258) MODEL IS SAVED ***
2023-05-26 08:52:08 [info     ] *** Best(0.244) MODEL IS SAVED ***
2023-05-26 08:52:29 [info     ] *** Best(0.230) MODEL IS SAVED ***
2023-05-26 08:52:51 [info     ] *** Best(0.216) MODEL IS SAVED ***
2023-05-26 08:53:18 [info     ] *** Best(0.203) MODEL IS SAVED ***
2023-05-26 08:53:42 [info     ] *** Best(0.190) MODEL IS SAVED ***
2023-05-26 08:54:08 [info     ] *** Best(0.178) MODEL IS SAVED ***
2023-05-26 08:54:37 [info     ] *** Best(0.168) MODEL IS SAVED ***
2023-05-26 08:55:05 [info     ] *** Best(0.158) MODEL IS SAVED ***
2023-05-26 08:55:05 [info     ] ***  MODEL IS SAVED ***
2023-05-26 08:55:05 [info     ]  - BEST Model Loading : TIMEBAND/outputs/stock.sample/all/models/netD_BEST.pth, TIMEBAND/outputs/stock.sample/all/models/netG_BEST.pth
2023-05-26 08:55:05 [info     ] *** Best() MODEL IS SAVED ***
2023-05-26 08:55:05 [info     ] Done (2/2) 
2023-05-26 08:55:05 [info     ] *********************
2023-05-26 08:55:05 [info     ] - Model Output -
2023-05-26 08:55:05 [info     ] *********************
2023-05-26 08:55:05 [info     ]  - BEST Model Loading : TIMEBAND/outputs/stock.sample/all/models/netD_BEST.pth, TIMEBAND/outputs/stock.sample/all/models/netG_BEST.pth
2023-05-26 08:55:06 [info     ]  - Data size : 2973
2023-05-26 08:55:06 [info     ] RUN the model
2023-05-26 08:55:10 [info     ] TIMEBAND/outputs/stock.sample/all/visualize.csv is saved
